## ğŸš€ å¿«é€Ÿå‚è€ƒï¼ˆå¿…è¯»ï¼‰

| è§„åˆ™ | è¯´æ˜ |
|------|------|
| **ç¦æ­¢çŒœæµ‹ Bug** | å¿…é¡»æœ‰ logã€æŠ¥é”™ä¿¡æ¯æˆ–æ•°æ®åº“è®°å½•ä½œä¸ºè¯æ® |
| **ç¦æ­¢é‡å¤é€ è½®å­** | å…ˆæŸ¥ç°æœ‰å‡½æ•°å’Œè¿ç§»ï¼Œä¼˜å…ˆå¤ç”¨ |
| **ğŸš¨ ç¦æ­¢ä¹±åŠ è¡¨æ ¼** | æ–°åŠŸèƒ½**ä¼˜å…ˆæ‰©å±•ç°æœ‰è¡¨**ï¼Œä¸è¦éšæ„æ–°å»ºè¡¨å¢åŠ ç³»ç»Ÿå¤æ‚æ€§ |
| **å…ˆç†è§£å†åŠ¨æ‰‹** | å†™æ–°åç«¯åŠŸèƒ½å‰ï¼Œ**å¿…é¡»å…ˆææ¸…æ¥šç°æœ‰ç³»ç»Ÿçš„è¿è¡ŒåŸç†å’Œé€»è¾‘** |
| **ä¸­æ–‡å›å¤** | å§‹ç»ˆç”¨ä¸­æ–‡ï¼Œè§£é‡ŠåŸç†å’Œæ“ä½œæ­¥éª¤ |
| **ä¿æŒå±€éƒ¨æ€§** | ä¸è¦éšæ„é‡æ„æ²¡æœ‰è¦æ±‚ä¿®æ”¹çš„æ¨¡å— |
| **æœç´¢ç½‘ä¸Šèµ„æ–™** | Bug æ’æŸ¥å’ŒæŠ€æœ¯è°ƒç ”å¿…é¡»å…ˆ WebSearch |
| **äº‘ç«¯ Supabase ä¼˜å…ˆ** | ç›´æ¥ä½¿ç”¨ MCP å·¥å…·æ“ä½œäº‘ç«¯ Supabaseï¼Œå¯ç›´æ¥éƒ¨ç½² |

---

## ğŸ“ é¡¹ç›®ç»“æ„

**è¿™æ˜¯ Lumi é¡¹ç›®çš„åç«¯ä»“åº“**ã€‚

### ä»“åº“åˆ†ç¦»è¯´æ˜

| ä»“åº“ | GitHub | æœ¬åœ°è·¯å¾„ | è¯´æ˜ |
|------|--------|---------|------|
| **åç«¯ï¼ˆå½“å‰ï¼‰** | [sylmmhy/Lumi-supabase](https://github.com/sylmmhy/Lumi-supabase.git) | å½“å‰ç›®å½• | Supabaseï¼šè¿ç§»ã€Edge Functions |
| **å‰ç«¯** | [sylmmhy/Lumi](https://github.com/sylmmhy/Lumi.git) | `../Lumi` | React + TypeScript + Vite |

> **å†å²èƒŒæ™¯**ï¼šä¸¤ä¸ªä»“åº“åŸæœ¬æ˜¯åŒä¸€ä¸ª repoï¼Œä¸ºäº† hackathon æ–¹ä¾¿è¿›è¡Œäº†åˆ† repo å¤„ç†ã€‚éƒ¨åˆ†é…ç½®å’Œè§„åˆ™åœ¨ä¸¤ä¸ªä»“åº“ä¸­ç›¸äº’å¼•ç”¨ã€‚
>
> **æœ¬åœ°ç›®å½•çº¦å®š**ï¼šä¸¤ä¸ªä»“åº“åº”æ”¾åœ¨åŒä¸€çˆ¶ç›®å½•ä¸‹ï¼Œå³ `Lumi/` å’Œ `Lumi-supabase/` æ˜¯å…„å¼Ÿç›®å½•ã€‚

### å½“å‰ä»“åº“ç»“æ„ï¼ˆåç«¯ï¼‰

```
Lumi-supabase/
â”œâ”€â”€ package.json          # npm è„šæœ¬ï¼ˆsupabase:start ç­‰ï¼‰
â”œâ”€â”€ scripts/              # è¾…åŠ©è„šæœ¬
â”œâ”€â”€ docs/                 # æ–‡æ¡£
â””â”€â”€ supabase/             # Supabase é¡¹ç›®ç›®å½•ï¼ˆæ ‡å‡†ç»“æ„ï¼‰
    â”œâ”€â”€ config.toml           # Supabase é¡¹ç›®é…ç½®
    â”œâ”€â”€ .env.local            # æœ¬åœ°ç¯å¢ƒå˜é‡ï¼ˆä¸æäº¤ï¼‰
    â”œâ”€â”€ .env.local.example    # ç¯å¢ƒå˜é‡æ¨¡æ¿
    â”œâ”€â”€ migrations/           # æ•°æ®åº“è¿ç§»æ–‡ä»¶ï¼ˆSQLï¼‰
    â”‚   â”œâ”€â”€ 00000000000000_schema.sql      # åŸºç¡€ schema
    â”‚   â””â”€â”€ 20260129*.sql                  # æŒ‰æ—¶é—´æˆ³å‘½åçš„è¿ç§»
    â”œâ”€â”€ functions/            # Edge Functionsï¼ˆTypeScript/Denoï¼‰
    â”‚   â”œâ”€â”€ _shared/          # å…±äº«æ¨¡å—
    â”‚   â”œâ”€â”€ memory-extractor/ # è®°å¿†æå–
    â”‚   â”œâ”€â”€ retrieve-memories/# è®°å¿†æ£€ç´¢
    â”‚   â”œâ”€â”€ seagull-chat/     # AI å¯¹è¯
    â”‚   â””â”€â”€ ...ï¼ˆ40+ ä¸ªå‡½æ•°ï¼‰
    â””â”€â”€ seed.sql              # ç§å­æ•°æ®
```

### å‰ç«¯ä»“åº“ç»“æ„ï¼ˆä¾›å‚è€ƒï¼‰

```
Lumi/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/       # React ç»„ä»¶
â”‚   â”œâ”€â”€ hooks/            # Hooksï¼ˆuseGeminiLive, useAICoachSessionï¼‰
â”‚   â””â”€â”€ pages/            # é¡µé¢
â”œâ”€â”€ docs/                 # å…±äº«æ–‡æ¡£ï¼ˆæ¶æ„ã€å®ç°è®°å½•ï¼‰
â””â”€â”€ public/               # é™æ€èµ„æº
```

### è·¨ä»“åº“æ“ä½œ

```bash
# æŸ¥çœ‹å‰ç«¯ä»“åº“
ls ../Lumi/

# åœ¨å‰ç«¯ä»“åº“æ‰§è¡Œ git æ“ä½œ
git -C ../Lumi status

# å‰ç«¯æ–‡æ¡£ç›®å½•ï¼ˆä¸¤ä¸ªä»“åº“å…±ç”¨æ–‡æ¡£è§„èŒƒï¼‰
ls ../Lumi/docs/
```

---

## ğŸ› ï¸ Skills / Subagents / Hooks ç´¢å¼•

### Skillsï¼ˆæŒ‰éœ€è‡ªåŠ¨åŠ è½½ï¼‰

| Skill | è·¯å¾„ | è§¦å‘åœºæ™¯ |
|-------|------|---------|
| **launch** | `.claude/skills/launch/SKILL.md` | è¯´ `/launch`ï¼Œå°† dev åŒæ­¥åˆ° master å‘å¸ƒ |
| **debugremote** | `.claude/skills/debugremote/SKILL.md` | è¯´ `/debugremote`ï¼Œåˆ‡æ¢åˆ°äº‘ç«¯ Supabase è°ƒè¯•æ¨¡å¼ï¼ˆMCP ç›´æ¥æ“ä½œï¼‰ |
| **debuglocal** | `.claude/skills/debuglocal/SKILL.md` | è¯´ `/debuglocal`ï¼Œæ¢å¤æœ¬åœ° Supabase ä¼˜å…ˆåŸåˆ™ |
| **debug-workflow** | `.claude/skills/debug-workflow/SKILL.md` | Bug æ’æŸ¥ã€è°ƒè¯•ã€é‡åˆ°é”™è¯¯æ—¶ |
| **tech-research** | `.claude/skills/tech-research/SKILL.md` | è¯„ä¼°æ–°æŠ€æœ¯/åŠŸèƒ½å¯è¡Œæ€§æ—¶ |
| **doc-maintenance** | `.claude/skills/doc-maintenance/SKILL.md` | è¿›è¡Œå¤æ‚å®ç°ã€å®ŒæˆåŠŸèƒ½ã€æ›´æ–°æ–‡æ¡£æ—¶ |
| **product-context** | `.claude/skills/product-context/SKILL.md` | æ¶‰åŠ Onboardingã€AI é›†æˆã€è®°å¿†ç³»ç»Ÿæ—¶ |

### Subagentsï¼ˆæ‰‹åŠ¨è§¦å‘ï¼‰

| Subagent | è·¯å¾„ | è§¦å‘æ–¹å¼ |
|----------|------|---------|
| **code-reviewer** | `.claude/agents/code-reviewer.md` | è¯´"å¸®æˆ‘å®¡æŸ¥ä»£ç " |
| **log-analyzer** | `.claude/agents/log-analyzer.md` | è¯´"åˆ†ææ—¥å¿—" |

### Hooksï¼ˆè‡ªåŠ¨æ‰§è¡Œï¼‰

| Hook | è§¦å‘æ—¶æœº | ä½œç”¨ |
|------|---------|------|
| `PostToolUse (Edit\|Write)` | æ¯æ¬¡ç¼–è¾‘/å†™å…¥æ–‡ä»¶å | è‡ªåŠ¨è¿è¡Œ `npm run lint` |
| `PreToolUse (git push)` | æ¨é€ä»£ç å‰ | è‡ªåŠ¨ä»£ç å®¡æŸ¥ |
| `commit-msg` (husky) | git commit æ—¶ | commitlint æ£€æŸ¥æ ¼å¼ |

---

## ğŸ“š æ–‡æ¡£ç»´æŠ¤ç³»ç»Ÿ

### æœ¬ä»“åº“æ–‡æ¡£ï¼ˆåç«¯ï¼‰

```
docs/
â””â”€â”€ supabase-local-development.md  # Supabase æœ¬åœ°å¼€å‘å®Œæ•´æŒ‡å—
```

### å‰ç«¯ä»“åº“æ–‡æ¡£ï¼ˆå…±äº«ï¼‰

```
../Lumi/docs/
â”œâ”€â”€ in-progress/          # è¿›è¡Œä¸­çš„å®ç°ï¼ˆå¿…é¡»å®æ—¶æ›´æ–°ï¼‰
â”œâ”€â”€ implementation-log/   # å·²å®Œæˆçš„å®ç°è®°å½•
â”œâ”€â”€ architecture/         # æ¶æ„æ–‡æ¡£ï¼ˆå«è®°å¿†ç³»ç»Ÿç­‰ï¼‰
â”œâ”€â”€ dev-guide/           # å¼€å‘/éƒ¨ç½²æŒ‡å—
â””â”€â”€ KEY_DECISIONS.md     # å…³é”®æŠ€æœ¯å†³ç­–
```

**è¯¦ç»†è§„åˆ™è§**ï¼š`.claude/skills/doc-maintenance/SKILL.md`

---

## ğŸ”§ å¸¸ç”¨å‘½ä»¤ï¼ˆåç«¯ï¼‰

```bash
# æœ¬åœ° Supabase æœåŠ¡
npm run supabase:start          # å¯åŠ¨æœ¬åœ° Supabase
npm run supabase:stop           # åœæ­¢æœ¬åœ° Supabase
npm run supabase:status         # æŸ¥çœ‹æœåŠ¡çŠ¶æ€

# æ•°æ®åº“è¿ç§»
npm run supabase:push:local     # åº”ç”¨è¿ç§»åˆ°æœ¬åœ°
npm run supabase:reset          # é‡ç½®æœ¬åœ°æ•°æ®åº“

# Edge Functionsï¼ˆéœ€è¦æ–°å¼€ç»ˆç«¯ï¼‰
npm run supabase:functions      # æœ¬åœ°è¿è¡Œå‡½æ•°ï¼ˆçƒ­é‡è½½ï¼‰

# æ•°æ®åº“æŸ¥è¯¢
npm run db:query "SELECT * FROM users LIMIT 10;"
```

> **å®Œæ•´æ–‡æ¡£**ï¼š`docs/supabase-local-development.md`

### å‰ç«¯å‘½ä»¤ï¼ˆåœ¨ `../Lumi` æ‰§è¡Œï¼‰

```bash
npm run dev      # å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run build    # æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run lint     # ä»£ç æ£€æŸ¥
```

---

## ğŸ—„ï¸ Supabase äº‘ç«¯æ“ä½œ
ä½¿ç”¨ Supabase MCP æ—¶ï¼Œå§‹ç»ˆä½¿ç”¨é…ç½®ä¸­çš„æ­£ç¡®é¡¹ç›® ID=ivlfsixvfovqitkajyjc

> **å½“å‰æ¨¡å¼ï¼šäº‘ç«¯ä¼˜å…ˆ**ï¼Œå¯ç›´æ¥æ“ä½œäº‘ç«¯ Supabaseã€‚

### âœ… å·²æˆæƒçš„äº‘ç«¯æ“ä½œ

| æ“ä½œ | å·¥å…·/å‘½ä»¤ | è¯´æ˜ |
|------|----------|------|
| **æ•°æ®åº“æŸ¥è¯¢/ä¿®æ”¹** | `mcp__supabase__execute_sql` | ç›´æ¥æ‰§è¡Œ SQL |
| **æŸ¥çœ‹è¡¨ç»“æ„** | `mcp__supabase__list_tables` | æŸ¥çœ‹äº‘ç«¯è¡¨ |
| **æŸ¥çœ‹æ—¥å¿—** | `mcp__supabase__get_logs` | æŸ¥çœ‹ Edge Function æ—¥å¿— |
| **éƒ¨ç½²å‡½æ•°** | `npx supabase functions deploy` | éƒ¨ç½²åˆ°äº‘ç«¯ |
| **æ¨é€è¿ç§»** | `npx supabase db push` | æ¨é€åˆ°äº‘ç«¯æ•°æ®åº“ |

### ğŸ“‹ äº‘ç«¯æ“ä½œæ³¨æ„äº‹é¡¹

- **å¤‡ä»½é‡è¦æ•°æ®**ï¼šäº‘ç«¯æ“ä½œæ˜¯å®æ—¶ç”Ÿæ•ˆçš„
- **è°¨æ…åˆ é™¤æ“ä½œ**ï¼šDELETE/DROP ç­‰æ“ä½œæ— æ³•æ’¤é”€
- **æµ‹è¯•åå†æ”¹ç»“æ„**ï¼šALTER TABLE ç­‰ç»“æ„å˜æ›´è¦å…ˆéªŒè¯

### ğŸ”„ åˆ‡æ¢åˆ°æœ¬åœ°æ¨¡å¼

å¦‚éœ€åˆ‡æ¢å›æœ¬åœ°ä¼˜å…ˆæ¨¡å¼ï¼Œä½¿ç”¨ `/debuglocal` å‘½ä»¤ã€‚

---

## âš ï¸ é‡è¦è§„åˆ™

### åç«¯å¼€å‘åŸåˆ™ï¼ˆç¦æ­¢ä¹±åŠ è¡¨æ ¼ï¼‰

> **æ ¸å¿ƒåŸåˆ™ï¼šå…ˆç†è§£ç°æœ‰ç³»ç»Ÿï¼Œå†å†³å®šå¦‚ä½•å®ç°ã€‚ä¼˜å…ˆæ‰©å±•ç°æœ‰è¡¨ï¼Œé¿å…å¢åŠ ç³»ç»Ÿå¤æ‚æ€§ã€‚**

#### ä¸ºä»€ä¹ˆä¸èƒ½éšæ„æ–°å»ºè¡¨ï¼Ÿ

- æ¯æ–°å¢ä¸€å¼ è¡¨ï¼Œå°±å¢åŠ äº†ï¼šå…³è”æŸ¥è¯¢å¤æ‚åº¦ã€è¿ç§»ç»´æŠ¤æˆæœ¬ã€RLS ç­–ç•¥é…ç½®ã€Edge Function çš„è°ƒç”¨é€»è¾‘
- å¾ˆå¤šæ—¶å€™ï¼Œ**åœ¨ç°æœ‰è¡¨ä¸ŠåŠ å‡ ä¸ªå­—æ®µ**å°±èƒ½è§£å†³é—®é¢˜ï¼Œæ¯”æ–°å»ºè¡¨ç®€å•å¾—å¤š

#### æ­£ç¡®æµç¨‹

1. **å…ˆææ¸…æ¥šç°æœ‰ç³»ç»Ÿæ€ä¹ˆè¿è¡Œçš„**
   - è¯»ç›¸å…³çš„è¿ç§»æ–‡ä»¶ï¼ˆ`supabase/migrations/`ï¼‰
   - è¯»ç›¸å…³çš„ Edge Function ä»£ç 
   - ç†è§£æ•°æ®æµï¼šå‰ç«¯è°ƒç”¨ â†’ Edge Function â†’ æ•°æ®åº“æ“ä½œ â†’ è¿”å›ç»“æœ

2. **è¯„ä¼°æ˜¯å¦éœ€è¦æ–°è¡¨**
   - âŒ é”™è¯¯æ€è·¯ï¼š"è¿™ä¸ªåŠŸèƒ½éœ€è¦å­˜æ•°æ®ï¼Œæˆ‘å»ºä¸ªæ–°è¡¨å§"
   - âœ… æ­£ç¡®æ€è·¯ï¼š"ç°æœ‰çš„ `xxx` è¡¨èƒ½ä¸èƒ½åŠ å‡ ä¸ªå­—æ®µæ¥æ”¯æŒè¿™ä¸ªåŠŸèƒ½ï¼Ÿ"

3. **å¦‚æœç¡®å®éœ€è¦æ–°è¡¨**
   - å¿…é¡»è§£é‡Šä¸ºä»€ä¹ˆç°æœ‰è¡¨æ— æ³•æ‰©å±•
   - è¯´æ˜æ–°è¡¨ä¸ç°æœ‰è¡¨çš„å…³ç³»ï¼ˆå¤–é”®ã€å…³è”ï¼‰

#### ç¤ºä¾‹

| åœºæ™¯ | âŒ é”™è¯¯åšæ³• | âœ… æ­£ç¡®åšæ³• |
|------|-----------|-----------|
| ç»™ç”¨æˆ·åŠ ä¸ª"åå¥½è®¾ç½®" | æ–°å»º `user_preferences` è¡¨ | åœ¨ `profiles` è¡¨åŠ  `preferences JSONB` å­—æ®µ |
| è®°å½•ç›®æ ‡çš„å­ä»»åŠ¡ | æ–°å»º `goal_subtasks` è¡¨ | å…ˆçœ‹ `goals` è¡¨æ˜¯å¦èƒ½ç”¨ `subtasks JSONB` å­—æ®µ |
| æ–°åŠŸèƒ½éœ€è¦å­˜çŠ¶æ€ | ç›´æ¥æ–°å»ºè¡¨ | å…ˆæŸ¥ç°æœ‰è¡¨ç»“æ„ï¼Œæ‰¾æœ€ç›¸å…³çš„è¡¨æ‰©å±• |

### Bug æ’æŸ¥åŸåˆ™ï¼ˆä¸¥ç¦çŒœæµ‹ï¼‰

- **ä¸¥ç¦**å‡­ç›´è§‰æˆ–ç»éªŒéšæ„çŒœæµ‹ Bug åŸå› 
- **å¿…é¡»**æ‰¾åˆ°å®é™…çš„ logã€æŠ¥é”™ä¿¡æ¯ã€æˆ–æ•°æ®åº“è®°å½•ä½œä¸ºè¯æ®
- å¦‚æœç°æœ‰ä»£ç æ²¡æœ‰ç›¸å…³æ—¥å¿—ï¼Œ**å¿…é¡»å…ˆæ·»åŠ æµ‹è¯• log**ï¼ˆå¦‚ `console.log`ï¼‰ï¼Œå¤ç°é—®é¢˜åå†åˆ†æ
- è§£é‡ŠåŸå› æ—¶ï¼Œ**ç”¨äº§å“ç»ç†èƒ½å¬æ‡‚çš„è¯**è¯´æ¸…æ¥šï¼š
  - âŒ é”™è¯¯ç¤ºèŒƒï¼š"å¯èƒ½æ˜¯ useEffect çš„ä¾èµ–æ•°ç»„å¯¼è‡´é‡å¤æ¸²æŸ“"
  - âœ… æ­£ç¡®ç¤ºèŒƒï¼š"é—®é¢˜æ˜¯ï¼šç”¨æˆ·ç‚¹å‡»æŒ‰é’®åï¼Œé¡µé¢åˆ·æ–°äº†ä¸¤æ¬¡ã€‚åŸå› æ˜¯ï¼šä»£ç åœ¨'ç”¨æˆ·ç™»å½•æˆåŠŸ'å’Œ'é¡µé¢åŠ è½½å®Œæˆ'æ—¶éƒ½è§¦å‘äº†è·³è½¬ï¼Œå¯¼è‡´è·³äº†ä¸¤æ¬¡ã€‚è¯æ®æ˜¯ï¼šæ§åˆ¶å°æ˜¾ç¤º `handleRedirect` è¢«è°ƒç”¨äº† 2 æ¬¡ï¼ˆé™„ log æˆªå›¾ï¼‰ã€‚"

### Bug æ’æŸ¥å¿…é¡»æœç´¢ç½‘ä¸Šèµ„æ–™

- **åŸå› **ï¼šAI æ¨¡å‹çš„è®­ç»ƒæ•°æ®ä¸æ˜¯æœ€æ–°çš„ï¼Œå¾ˆå¤šæ–°ç‰ˆæœ¬çš„ API å˜æ›´ã€å·²çŸ¥ bugã€ç¤¾åŒºè§£å†³æ–¹æ¡ˆå¯èƒ½ä¸åœ¨è®­ç»ƒæ•°æ®ä¸­
- **å¿…é¡»**ä½¿ç”¨ WebSearch æœç´¢ï¼šå®˜æ–¹æ–‡æ¡£ã€GitHub Issuesã€Stack Overflow
- **æœç´¢å…³é”®è¯**ï¼š`[åº“å] + [ç‰ˆæœ¬å·] + [é”™è¯¯ä¿¡æ¯æˆ–ç—‡çŠ¶]`
- **ä¼˜å…ˆé‡‡çº³**ï¼šå®˜æ–¹æ¨è > é«˜èµç¤¾åŒºæ–¹æ¡ˆ > è‡ªå·±æ‘¸ç´¢

### æŠ€æœ¯å¯è¡Œæ€§è°ƒç ”

- **ç›®çš„**ï¼šåœ¨å¼€å§‹å®ç°å‰ï¼Œè¯†åˆ«å¯èƒ½æ— æ³•è§£å†³çš„æŠ€æœ¯éšœç¢
- **è¾“å‡ºæ ¼å¼**ï¼š
  ```
  âœ… å¯è¡Œï¼š[å®˜æ–¹æ”¯æŒçš„åŠŸèƒ½ç‚¹]
  âš ï¸ é£é™©ï¼š[æœ‰å·²çŸ¥ bug ä½†æœ‰ workaround çš„ç‚¹]
  âŒ ä¸å¯è¡Œï¼š[å®˜æ–¹ä¸æ”¯æŒ / è‡³ä»Šæ— è§£çš„ç‚¹]
  ```

**è¯¦ç»†æµç¨‹è§**ï¼š`.claude/skills/debug-workflow/SKILL.md` å’Œ `.claude/skills/tech-research/SKILL.md`

---

## ğŸ¯ æ ¸å¿ƒäº§å“é€»è¾‘

> å‰ç«¯ç›¸å…³é€»è¾‘è§å‰ç«¯ä»“åº“ `../Lumi/`

### åç«¯æ ¸å¿ƒåŠŸèƒ½

#### 1. è®°å¿†ç³»ç»Ÿï¼ˆæœ¬ä»“åº“é‡ç‚¹ï¼‰

**ç›¸å…³æ–‡ä»¶**ï¼š
- `migrations/20260127100000_tolan_memory_system.sql` - è®°å¿†è¡¨ç»“æ„
- `migrations/20260127120000_tiered_memory_search.sql` - åˆ†å±‚æ£€ç´¢
- `functions/memory-extractor/` - è®°å¿†æå– Edge Function
- `functions/retrieve-memories/` - è®°å¿†æ£€ç´¢ Edge Function
- `functions/memory-compressor/` - è®°å¿†å‹ç¼©

**è®°å¿†æ ‡ç­¾åˆ†ç±»ï¼ˆ6 ç§ï¼‰**ï¼š
| æ ‡ç­¾ | å«ä¹‰ | åŠ è½½ç­–ç•¥ |
|------|------|---------|
| **PREF** | AI äº¤äº’åå¥½ | **å§‹ç»ˆåŠ è½½** |
| **PROC** | æ‹–å»¶åŸå›  | æŒ‰ä»»åŠ¡ä¸Šä¸‹æ–‡ |
| **SOMA** | èº«å¿ƒååº” | æŒ‰ä»»åŠ¡ä¸Šä¸‹æ–‡ |
| **EMO** | æƒ…ç»ªè§¦å‘ | æŒ‰ä»»åŠ¡ä¸Šä¸‹æ–‡ |
| **SAB** | è‡ªæˆ‘å¦¨ç¢ | æŒ‰ä»»åŠ¡ä¸Šä¸‹æ–‡ |
| **EFFECTIVE** | æœ‰æ•ˆæ¿€åŠ±æ–¹å¼ | **å§‹ç»ˆåŠ è½½** |

#### 2. ç›®æ ‡ç³»ç»Ÿ

**ç›¸å…³æ–‡ä»¶**ï¼š
- `migrations/20260129110000_create_goals_tables.sql` - ç›®æ ‡è¡¨ç»“æ„
- `migrations/20260129140000_goal_memory_integration.sql` - ç›®æ ‡è®°å¿†é›†æˆ
- `functions/daily-goal-adjustment/` - æ¯æ—¥ç›®æ ‡è°ƒæ•´

#### 3. AI å¯¹è¯

**ç›¸å…³æ–‡ä»¶**ï¼š
- `functions/seagull-chat/` - ä¸»å¯¹è¯å‡½æ•°
- `functions/get-system-instruction/` - ç³»ç»Ÿæç¤ºè¯ç”Ÿæˆ
- `functions/_shared/` - å…±äº«æ¨¡å—ï¼ˆDifyã€ElevenLabs ç­‰ï¼‰

**è¯¦ç»†ä¿¡æ¯è§**ï¼š`.claude/skills/product-context/SKILL.md`

---

## ğŸ“¦ å¯å¤ç”¨çš„åç«¯æ¨¡å—

### å…±äº«æ¨¡å— (`functions/_shared/`)
- `dify.ts` - Dify AI å¯¹è¯é›†æˆ
- `elevenlabs.ts` - ElevenLabs è¯­éŸ³åˆæˆ
- `transcription.ts` - è¯­éŸ³è½¬æ–‡å­—
- `voice.ts` - è¯­éŸ³å¤„ç†å·¥å…·
- `http.ts` - HTTP è¯·æ±‚å·¥å…·

### æ ¸å¿ƒ Edge Functions
- `seagull-chat/` - AI å¯¹è¯ä¸»å‡½æ•°
- `memory-extractor/` - è®°å¿†æå–
- `retrieve-memories/` - è®°å¿†æ£€ç´¢
- `get-system-instruction/` - ç³»ç»Ÿæç¤ºè¯

> **å‰ç«¯ç»„ä»¶åº“**è§å‰ç«¯ä»“åº“ `../Lumi/` çš„ CLAUDE.md

---

## ğŸ‘¤ ç”¨æˆ·ä¸æ²Ÿé€šåŸåˆ™

**ä½ çš„ç”¨æˆ·æ˜¯ç¼–ç¨‹åˆå­¦è€…**ï¼ˆæ²¡æœ‰ GitHub/VS Code ç»éªŒï¼‰

1. **è¯­è¨€**ï¼šå§‹ç»ˆä½¿ç”¨**ä¸­æ–‡**å›å¤
2. **è§£é‡Š**ï¼šæ¯ä¸€æ­¥æ“ä½œéƒ½è¦è§£é‡Š"ä¸ºä»€ä¹ˆè¦åšè¿™ä¸€æ­¥"ä»¥åŠ"åŸç†æ˜¯ä»€ä¹ˆ"
3. **æŒ‡ä»¤**ï¼šæ¸…æ¥šåœ°å‘Šè¯‰ç”¨æˆ·åœ¨å“ªä¸ªæ–‡ä»¶çš„å“ªä¸€è¡Œä¿®æ”¹
4. **æ³¨é‡Š**ï¼šä»£ç å¿…é¡»åŒ…å«è¯¦ç»†çš„ JSDoc æ³¨é‡Š

---

## ğŸ“ æŠ€æœ¯æ ˆä¸ä»£ç è§„èŒƒ

### åç«¯ï¼ˆæœ¬ä»“åº“ï¼‰
- **å¹³å°**ï¼šSupabaseï¼ˆPostgreSQL + Edge Functionsï¼‰
- **Edge Functions**ï¼šTypeScript + Deno è¿è¡Œæ—¶
- **æ•°æ®åº“**ï¼šPostgreSQL + pgvectorï¼ˆå‘é‡æœç´¢ï¼‰
- **AI é›†æˆ**ï¼šDifyã€ElevenLabsã€Google Gemini

### å‰ç«¯ï¼ˆ`../Lumi/`ï¼‰
- **æ¡†æ¶**ï¼šReact 19 + TypeScript + Vite
- **è·¯ç”±**ï¼šReact Router DOM v7
- **æ ·å¼**ï¼šTailwind CSS

### é€šç”¨è§„èŒƒ
- **Git**ï¼šéµå¾ª Conventional Commitsï¼Œä¸­æ–‡æè¿°
- **æ³¨é‡Š**ï¼šæ‰€æœ‰å¯¼å‡ºçš„å‡½æ•°å¿…é¡»åŒ…å« JSDoc æ³¨é‡Š

---

## ç¡çœ ç³»ç»Ÿå¼€å‘è§„åˆ™

### i18n å¿…é¡»ä½¿ç”¨ t() å‡½æ•°
- âŒ `language === 'zh' ? 'ä¸­æ–‡' : 'English'`
- âœ… `t('profile.sleepScore.title')`
- æ–°ç»„ä»¶å¿…é¡»å…ˆåœ¨ zh.json/en.json æ·»åŠ ç¿»è¯‘é”®ï¼Œå†ç”¨ `t()` å¼•ç”¨

### é¿å…é‡å¤è§£æ HealthKit æ•°æ®
- `parseSleepNights` æ˜¯ O(n log n)ï¼ŒåŒä¸€ä»½ healthData åªè°ƒç”¨ä¸€æ¬¡
- ç”¨ `calculateSleepDebtFromNights(nights)` è€Œé `calculateSleepDebt(healthData)`
- å¤šä¸ªæ´¾ç”Ÿå€¼åˆå¹¶ä¸ºä¸€ä¸ª `useMemo`ï¼Œä¸è¦æ‹†æˆå¤šä¸ª `useEffect`

### å¼‚æ­¥ useEffect å¿…é¡»é˜²ç«æ€
```ts
useEffect(() => {
  let cancelled = false;
  fetchData().then(d => { if (!cancelled) setState(d); });
  return () => { cancelled = true; };
}, [deps]);
```

### ç”Ÿäº§ç¯å¢ƒç¦æ­¢è£¸ console.log
- è°ƒè¯•æ—¥å¿—ç”¨ `if (import.meta.env.DEV)` åŒ…è£¹
- `console.error` å¯ä¿ç•™
