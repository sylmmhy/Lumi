# Routine ä»»åŠ¡æ‰“å¡åŠŸèƒ½å®ç°æŒ‡å—

## âœ… å·²å®Œæˆçš„å·¥ä½œ

### 1. åˆ›å»ºæ•°æ®åº“è¡¨ âœ…

**è¡¨å**ï¼š`routine_completions`

**ç”¨é€”**ï¼šè®°å½•æ¯ä¸ª Routine ä»»åŠ¡çš„æ¯æ—¥å®Œæˆæƒ…å†µï¼Œç”¨äºç”Ÿæˆæ‰“å¡æ—¥å†ï¼ˆç±»ä¼¼ GitHub è´¡çŒ®å›¾ï¼‰

**è¡¨ç»“æ„**ï¼š

| å­—æ®µå | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| `id` | UUID | ä¸»é”® |
| `user_id` | UUID | ç”¨æˆ· IDï¼Œå¤–é”®å…³è” `users` è¡¨ |
| `task_id` | UUID | ä»»åŠ¡ IDï¼Œå¤–é”®å…³è” `tasks` è¡¨ |
| `completion_date` | DATE | å®Œæˆæ—¥æœŸ (YYYY-MM-DD) |
| `created_at` | TIMESTAMP | åˆ›å»ºæ—¶é—´ |
| `updated_at` | TIMESTAMP | æ›´æ–°æ—¶é—´ |

**çº¦æŸ**ï¼š
- `UNIQUE(task_id, completion_date)` - ç¡®ä¿æ¯ä¸ªä»»åŠ¡æ¯å¤©åªèƒ½æœ‰ä¸€æ¡å®Œæˆè®°å½•
- RLS (Row Level Security) å·²å¯ç”¨ - ç”¨æˆ·åªèƒ½è®¿é—®è‡ªå·±çš„å®Œæˆè®°å½•

**ç´¢å¼•**ï¼š
- `idx_routine_completions_user_id` - æŒ‰ç”¨æˆ· ID æŸ¥è¯¢
- `idx_routine_completions_task_id` - æŒ‰ä»»åŠ¡ ID æŸ¥è¯¢
- `idx_routine_completions_date` - æŒ‰æ—¥æœŸæŸ¥è¯¢
- `idx_routine_completions_user_task` - å¤åˆç´¢å¼•ï¼Œä¼˜åŒ–ç”¨æˆ·+ä»»åŠ¡æŸ¥è¯¢

---

### 2. åˆ›å»ºæœåŠ¡å±‚å‡½æ•° âœ…

**æ–‡ä»¶**ï¼š`src/remindMe/services/routineCompletionService.ts`

**æä¾›çš„å‡½æ•°**ï¼š

#### åŸºç¡€æ“ä½œ

```typescript
// æ ‡è®°ä»»åŠ¡åœ¨æŒ‡å®šæ—¥æœŸå®Œæˆ
markRoutineComplete(userId: string, taskId: string, date?: string): Promise<RoutineCompletion | null>

// å–æ¶ˆä»»åŠ¡åœ¨æŒ‡å®šæ—¥æœŸçš„å®ŒæˆçŠ¶æ€
unmarkRoutineComplete(userId: string, taskId: string, date?: string): Promise<boolean>

// åˆ‡æ¢ä»»åŠ¡çš„å®ŒæˆçŠ¶æ€ï¼ˆè‡ªåŠ¨åˆ¤æ–­æ˜¯æ ‡è®°è¿˜æ˜¯å–æ¶ˆï¼‰
toggleRoutineCompletion(userId: string, taskId: string, date?: string): Promise<boolean>

// æ£€æŸ¥ä»»åŠ¡åœ¨æŒ‡å®šæ—¥æœŸæ˜¯å¦å·²å®Œæˆ
isRoutineCompletedOnDate(userId: string, taskId: string, date?: string): Promise<boolean>
```

#### æŸ¥è¯¢æ“ä½œ

```typescript
// è·å–æŒ‡å®šä»»åŠ¡çš„æ‰€æœ‰å®Œæˆè®°å½•
getRoutineCompletions(
  userId: string,
  taskId: string,
  startDate?: string,
  endDate?: string
): Promise<RoutineCompletion[]>

// è·å–ç”¨æˆ·æ‰€æœ‰ Routine ä»»åŠ¡çš„å®Œæˆè®°å½•ï¼ˆæŒ‰ä»»åŠ¡åˆ†ç»„ï¼‰
getAllRoutineCompletions(
  userId: string,
  startDate?: string,
  endDate?: string
): Promise<Map<string, Set<string>>>
```

---

### 3. åˆ›å»ºçƒ­åŠ›å›¾ç»„ä»¶ âœ…

**æ–‡ä»¶**ï¼š`src/components/app-tabs/RoutineHeatmap.tsx`

**åŠŸèƒ½**ï¼š
- âœ… æ˜¾ç¤ºä»ä»»åŠ¡åˆ›å»ºæ—¥æœŸåˆ°ä»Šå¤©çš„æ‰€æœ‰æ—¥æœŸ
- âœ… æ ¼å­æŒ‰æœˆä»½å’Œæ˜ŸæœŸå‡ æ’åˆ—ï¼ˆç±»ä¼¼ GitHub è´¡çŒ®å›¾ï¼‰
- âœ… æ ¼å­é¢œè‰²å¾ªç¯ï¼šé‡‘é»„è‰² â†’ æ·¡è“è‰² â†’ æ·¡çº¢è‰²ï¼ˆä¸ä»»åŠ¡æ— å…³ï¼Œåªä¸æ—¥æœŸåºå·æœ‰å…³ï¼‰
- âœ… ç‚¹äº®å·²å®Œæˆçš„æ—¥æœŸæ ¼å­
- âœ… æ˜¾ç¤ºæœˆä»½æ ‡ç­¾ï¼ˆJan, Feb, Mar...ï¼‰
- âœ… æ˜¾ç¤ºæ˜ŸæœŸæ ‡ç­¾ï¼ˆMon, Wed, Friï¼‰

**æ•ˆæœ**ï¼š
```
     Jan  Feb  Mar  Apr  May  Jun
Mon  â¬œâ¬œâ¬œğŸŸ¨ğŸŸ¨ğŸŸ¨â¬œâ¬œğŸŸ¦ğŸŸ¦ğŸŸ¦â¬œâ¬œ
Wed  ğŸŸ¨ğŸŸ¨â¬œâ¬œâ¬œğŸŸ¦ğŸŸ¦ğŸŸ¦â¬œâ¬œğŸŸ¥ğŸŸ¥ğŸŸ¥
Fri  â¬œğŸŸ¦ğŸŸ¦â¬œâ¬œğŸŸ¥ğŸŸ¥â¬œâ¬œğŸŸ¨ğŸŸ¨â¬œâ¬œ
```

---

### 4. åˆ›å»º Routine ä»»åŠ¡é¡¹ç»„ä»¶ âœ…

**æ–‡ä»¶**ï¼š`src/components/app-tabs/RoutineTaskItem.tsx`

**åŠŸèƒ½**ï¼š
- âœ… ç»§æ‰¿ `TaskItem` çš„æ‰€æœ‰åŠŸèƒ½ï¼ˆå‹¾é€‰ã€æ»‘åŠ¨åˆ é™¤ç­‰ï¼‰
- âœ… **åªèƒ½å‹¾é€‰/å–æ¶ˆä»Šå¤©çš„ä»»åŠ¡**ï¼ˆè¿‡å»å’Œæœªæ¥çš„æ—¥æœŸä¸èƒ½æ“ä½œï¼‰
- âœ… æ˜¾ç¤ºä»»åŠ¡çš„å®Œæˆå†å²çƒ­åŠ›å›¾
- âœ… æ”¯æŒå±•å¼€/æ”¶èµ·çƒ­åŠ›å›¾
- âœ… å®æ—¶æ›´æ–°å®ŒæˆçŠ¶æ€

**å…³é”®ç‰¹æ€§**ï¼š

```typescript
// åªèƒ½æ“ä½œä»Šå¤©çš„ä»»åŠ¡
const handleToggleToday = async () => {
  const today = new Date().toISOString().split('T')[0];
  // åˆ‡æ¢ä»Šå¤©çš„å®ŒæˆçŠ¶æ€
  const newStatus = await toggleRoutineCompletion(userId, task.id, today);
  // æ›´æ–° UI
  setIsTodayCompleted(newStatus);
};
```

---

### 5. æ›´æ–° TaskGroup ç»„ä»¶ âœ…

**æ–‡ä»¶**ï¼š`src/components/app-tabs/TaskGroup.tsx`

**ä¿®æ”¹å†…å®¹**ï¼š
- âœ… æ ¹æ®ä»»åŠ¡ç±»å‹é€‰æ‹©ç»„ä»¶
  - `todo` ä»»åŠ¡ â†’ ä½¿ç”¨ `TaskItem`
  - `routine` ä»»åŠ¡ â†’ ä½¿ç”¨ `RoutineTaskItem`ï¼ˆå¸¦çƒ­åŠ›å›¾ï¼‰
- âœ… ä¼ é€’å®Œæˆå†å²æ•°æ®ç»™ Routine ä»»åŠ¡
- âœ… ä¼ é€’å›è°ƒå‡½æ•°ç”¨äºæ›´æ–°å®Œæˆå†å²

---

### 6. æ›´æ–° HomeView ç»„ä»¶ âœ…

**æ–‡ä»¶**ï¼š`src/components/app-tabs/HomeView.tsx`

**ä¿®æ”¹å†…å®¹**ï¼š
- âœ… æ·»åŠ  `routineCompletions` å±æ€§ï¼ˆå®Œæˆå†å²æ•°æ®ï¼‰
- âœ… æ·»åŠ  `onRoutineCompletionChange` å›è°ƒå‡½æ•°
- âœ… å°†è¿™äº›å±æ€§ä¼ é€’ç»™ `TaskGroup` ç»„ä»¶

---

### 7. æ›´æ–° AppTabsPage âœ…

**æ–‡ä»¶**ï¼š`src/pages/AppTabsPage.tsx`

**ä¿®æ”¹å†…å®¹**ï¼š
- âœ… æ·»åŠ  `routineCompletions` çŠ¶æ€ç®¡ç†
- âœ… åœ¨åŠ è½½ä»»åŠ¡æ—¶åŒæ—¶åŠ è½½å®Œæˆå†å²
- âœ… æ·»åŠ  `handleRoutineCompletionChange` å›è°ƒå‡½æ•°
- âœ… å°†å®Œæˆå†å²å’Œå›è°ƒå‡½æ•°ä¼ é€’ç»™ `HomeView`

---

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

### âœ… å·²å®ç°çš„åŠŸèƒ½

1. **æ¯æ—¥æ‰“å¡è®°å½•**
   - ç”¨æˆ·å‹¾é€‰ Routine ä»»åŠ¡æ—¶ï¼Œè‡ªåŠ¨è®°å½•ä»Šå¤©çš„å®ŒæˆçŠ¶æ€
   - æ•°æ®å­˜å‚¨åœ¨ `routine_completions` è¡¨ä¸­

2. **æ‰“å¡å†å²å¯è§†åŒ–**
   - ç±»ä¼¼ GitHub è´¡çŒ®å›¾çš„çƒ­åŠ›å›¾æ˜¾ç¤º
   - æ ¼å­æŒ‰æœˆä»½å’Œæ˜ŸæœŸæ’åˆ—
   - æ ¼å­é¢œè‰²å¾ªç¯ï¼šé»„â†’è“â†’çº¢

3. **åªèƒ½ç‚¹äº®ä»Šå¤©çš„æ ¼å­**
   - âœ… **æ ¸å¿ƒç‰¹æ€§**ï¼šç”¨æˆ·åªèƒ½å‹¾é€‰/å–æ¶ˆä»Šå¤©çš„ä»»åŠ¡
   - è¿‡å»å’Œæœªæ¥çš„æ—¥æœŸä¸èƒ½æ“ä½œ
   - é˜²æ­¢ç”¨æˆ·"è¡¥ç­¾"æˆ–"é¢„ç­¾"

4. **å±•å¼€/æ”¶èµ·çƒ­åŠ›å›¾**
   - ç”¨æˆ·å¯ä»¥ç‚¹å‡»æŒ‰é’®å±•å¼€æŸ¥çœ‹å®Œæ•´å†å²
   - æ”¶èµ·æ—¶åªæ˜¾ç¤ºä»»åŠ¡ä¿¡æ¯ï¼ŒèŠ‚çœç©ºé—´

5. **å®æ—¶åŒæ­¥**
   - å®ŒæˆçŠ¶æ€å®æ—¶ä¿å­˜åˆ° Supabase
   - çƒ­åŠ›å›¾å®æ—¶æ›´æ–°

---

## ğŸ“± ç”¨æˆ·ä½“éªŒ

### æ“ä½œæµç¨‹

1. **åˆ›å»º Routine ä»»åŠ¡**
   ```
   ç”¨æˆ·åœ¨ HomeView ä¸­ï¼š
   â”œâ”€ è¾“å…¥ä»»åŠ¡å†…å®¹ï¼š"æ¯å¤©è·‘æ­¥"
   â”œâ”€ é€‰æ‹©æ—¶é—´ï¼š"7:00 am"
   â”œâ”€ å‹¾é€‰ "Routine task"
   â””â”€ ç‚¹å‡» "Set" æŒ‰é’®
   ```

2. **æŸ¥çœ‹ Routine ä»»åŠ¡**
   ```
   åœ¨ä»»åŠ¡åˆ—è¡¨ä¸­ï¼š
   â”œâ”€ ä»»åŠ¡æ˜¾ç¤ºä¸º RoutineTaskItem
   â”œâ”€ å³ä¾§æœ‰å±•å¼€æŒ‰é’® (â–¼)
   â””â”€ ç‚¹å‡»å±•å¼€å¯æŸ¥çœ‹æ‰“å¡å†å²
   ```

3. **å®Œæˆä»Šå¤©çš„ä»»åŠ¡**
   ```
   ç”¨æˆ·å‹¾é€‰ä»»åŠ¡ï¼š
   â”œâ”€ ç‚¹å‡»ä»»åŠ¡å‰çš„å‹¾é€‰æ¡†
   â”œâ”€ ç³»ç»Ÿè®°å½•ä»Šå¤©çš„å®ŒæˆçŠ¶æ€
   â”œâ”€ çƒ­åŠ›å›¾ä¸­ä»Šå¤©çš„æ ¼å­è¢«ç‚¹äº®
   â””â”€ åªèƒ½æ“ä½œä»Šå¤©ï¼Œä¸èƒ½ç‚¹äº®æ˜¨å¤©æˆ–æ˜å¤©
   ```

4. **æŸ¥çœ‹æ‰“å¡å†å²**
   ```
   å±•å¼€çƒ­åŠ›å›¾ï¼š
   â”œâ”€ æ˜¾ç¤ºä»ä»»åŠ¡åˆ›å»ºæ—¥æœŸåˆ°ä»Šå¤©çš„æ‰€æœ‰æ ¼å­
   â”œâ”€ å·²å®Œæˆçš„æ—¥æœŸæ ¼å­è¢«ç‚¹äº®ï¼ˆé»„/è“/çº¢ï¼‰
   â”œâ”€ æœªå®Œæˆçš„æ—¥æœŸæ ¼å­ä¸ºç°è‰²
   â””â”€ æŒ‰æœˆä»½å’Œæ˜ŸæœŸæ’åˆ—
   ```

---

## ğŸ¨ è§†è§‰è®¾è®¡

### æ ¼å­é¢œè‰²ç³»ç»Ÿ

æ ¼å­é¢œè‰²ä¸ä»»åŠ¡æ— å…³ï¼Œåªä¸æ—¥æœŸçš„åºå·æœ‰å…³ï¼ŒæŒ‰ç…§ä»¥ä¸‹è§„åˆ™å¾ªç¯ï¼š

```typescript
ç¬¬ 0 å¤©ï¼šé‡‘é»„è‰² (#D4AF37)
ç¬¬ 1 å¤©ï¼šæ·¡è“è‰² (#A3C4D9)
ç¬¬ 2 å¤©ï¼šæ·¡çº¢è‰² (#E89B9B)
ç¬¬ 3 å¤©ï¼šé‡‘é»„è‰² (é‡å¤)
ç¬¬ 4 å¤©ï¼šæ·¡è“è‰² (é‡å¤)
...
```

### æ ¼å­çŠ¶æ€

- **å·²å®Œæˆ**ï¼šæ˜¾ç¤ºå¯¹åº”çš„é¢œè‰²ï¼ˆé»„/è“/çº¢ï¼‰
- **æœªå®Œæˆ**ï¼šç°è‰² (#E5E5E5)
- **å°ºå¯¸**ï¼š8x8 åƒç´ ï¼Œåœ†è§’ 2px
- **é—´è·**ï¼šæ ¼å­ä¹‹é—´é—´éš” 4px

### å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Jan   Feb   Mar   Apr   May   Jun ...  â”‚  â† æœˆä»½æ ‡ç­¾
â”œâ”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚M â”‚ â¬œğŸŸ¨ğŸŸ¦â¬œâ¬œğŸŸ¥â¬œâ¬œğŸŸ¨ğŸŸ¦â¬œğŸŸ¥â¬œâ¬œğŸŸ¨ â”‚ â”‚  â† Monday
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚W â”‚ ğŸŸ¨â¬œğŸŸ¥â¬œğŸŸ¨â¬œğŸŸ¦â¬œâ¬œğŸŸ¥â¬œğŸŸ¨â¬œğŸŸ¦â¬œ â”‚ â”‚  â† Wednesday
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚F â”‚ â¬œğŸŸ¥â¬œğŸŸ¨â¬œğŸŸ¦â¬œğŸŸ¨â¬œâ¬œğŸŸ¥â¬œğŸŸ¦â¬œğŸŸ¨ â”‚ â”‚  â† Friday
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š æ•°æ®æµ

### åˆ›å»º Routine ä»»åŠ¡

```
ç”¨æˆ·åˆ›å»ºä»»åŠ¡
  â†“
AppTabsPage.addTask()
  â†“
createReminder() â†’ ä¿å­˜åˆ° tasks è¡¨
  â†“
task.type = 'routine'
task.isRecurring = true
```

### å‹¾é€‰ä»Šå¤©çš„ä»»åŠ¡

```
ç”¨æˆ·ç‚¹å‡»å‹¾é€‰æ¡†
  â†“
RoutineTaskItem.handleToggleToday()
  â†“
toggleRoutineCompletion() â†’ ä¿å­˜åˆ° routine_completions è¡¨
  â†“
æ›´æ–° completedDates (Set<string>)
  â†“
é€šçŸ¥ AppTabsPage æ›´æ–° routineCompletions
  â†“
çƒ­åŠ›å›¾è‡ªåŠ¨åˆ·æ–°
```

### åŠ è½½ä»»åŠ¡å’Œå†å²

```
AppTabsPage åˆå§‹åŒ–
  â†“
fetchReminders() â†’ åŠ è½½ä»Šå¤©çš„ä»»åŠ¡
  â†“
getAllRoutineCompletions() â†’ åŠ è½½å®Œæˆå†å²
  â†“
è®¾ç½® tasks å’Œ routineCompletions çŠ¶æ€
  â†“
ä¼ é€’ç»™ HomeView â†’ TaskGroup â†’ RoutineTaskItem
  â†“
RoutineHeatmap æ¸²æŸ“çƒ­åŠ›å›¾
```

---

## ğŸ”’ æ ¸å¿ƒçº¦æŸ

### 1. åªèƒ½ç‚¹äº®ä»Šå¤©çš„æ ¼å­

**å®ç°æ–¹å¼**ï¼š

```typescript
const today = new Date().toISOString().split('T')[0];

// åœ¨ RoutineTaskItem ä¸­
const handleToggleToday = async () => {
  // å¼ºåˆ¶ä½¿ç”¨ä»Šå¤©çš„æ—¥æœŸ
  const newStatus = await toggleRoutineCompletion(userId, task.id, today);
  // ...
};
```

**ä¸ºä»€ä¹ˆè¿™æ ·è®¾è®¡**ï¼š
- é˜²æ­¢ç”¨æˆ·"è¡¥ç­¾"ï¼ˆç‚¹äº®è¿‡å»çš„æ—¥æœŸï¼‰
- é˜²æ­¢ç”¨æˆ·"é¢„ç­¾"ï¼ˆç‚¹äº®æœªæ¥çš„æ—¥æœŸï¼‰
- ä¿è¯æ‰“å¡æ•°æ®çš„çœŸå®æ€§

### 2. æ¯ä¸ªä»»åŠ¡æ¯å¤©åªèƒ½æœ‰ä¸€æ¡è®°å½•

**æ•°æ®åº“çº¦æŸ**ï¼š
```sql
UNIQUE(task_id, completion_date)
```

**æ•ˆæœ**ï¼š
- å³ä½¿ç”¨æˆ·å¤šæ¬¡å‹¾é€‰ï¼Œä¹Ÿåªä¼šè®°å½•ä¸€æ¬¡
- å–æ¶ˆå‹¾é€‰ä¼šåˆ é™¤è®°å½•ï¼Œè€Œä¸æ˜¯åˆ›å»ºæ–°è®°å½•

---

## ğŸš€ ä½¿ç”¨ç¤ºä¾‹

### åˆ›å»º Routine ä»»åŠ¡

```typescript
const routineTask: Task = {
  id: Date.now().toString(),
  text: 'æ¯å¤©è·‘æ­¥ 30 åˆ†é’Ÿ',
  time: '07:00',
  displayTime: '7:00 am',
  date: '2025-11-26',
  completed: false,
  type: 'routine',
  category: 'morning',
  called: false,
  isRecurring: true,
  recurrencePattern: 'daily',
};

await createReminder(routineTask, userId);
```

### å‹¾é€‰ä»Šå¤©çš„ä»»åŠ¡

```typescript
// ç”¨æˆ·ç‚¹å‡»å‹¾é€‰æ¡†
const newStatus = await toggleRoutineCompletion(userId, taskId, today);

// ç»“æœï¼š
// - newStatus = true â†’ ä»Šå¤©å·²å®Œæˆ
// - routine_completions è¡¨ä¸­æ–°å¢ä¸€æ¡è®°å½•
// - çƒ­åŠ›å›¾ä¸­ä»Šå¤©çš„æ ¼å­è¢«ç‚¹äº®
```

### æŸ¥è¯¢æ‰“å¡å†å²

```typescript
// è·å–æ‰€æœ‰ Routine ä»»åŠ¡çš„å®Œæˆå†å²
const completions = await getAllRoutineCompletions(userId);

// ç»“æœï¼šMap<taskId, Set<completionDate>>
// ä¾‹å¦‚ï¼š
// {
//   'task-123': Set(['2025-11-20', '2025-11-21', '2025-11-26']),
//   'task-456': Set(['2025-11-22', '2025-11-25', '2025-11-26']),
// }
```

---

## ğŸ“š ç›¸å…³æ–‡ä»¶

### æ ¸å¿ƒæ–‡ä»¶

- **æ•°æ®åº“è¿ç§»**ï¼š`supabase/migrations/create_routine_completions_table.sql`
- **æœåŠ¡å±‚**ï¼š`src/remindMe/services/routineCompletionService.ts`
- **çƒ­åŠ›å›¾ç»„ä»¶**ï¼š`src/components/app-tabs/RoutineHeatmap.tsx`
- **ä»»åŠ¡é¡¹ç»„ä»¶**ï¼š`src/components/app-tabs/RoutineTaskItem.tsx`
- **ä»»åŠ¡ç»„ç»„ä»¶**ï¼š`src/components/app-tabs/TaskGroup.tsx`
- **ä¸»é¡µè§†å›¾**ï¼š`src/components/app-tabs/HomeView.tsx`
- **é¡µé¢å®¹å™¨**ï¼š`src/pages/AppTabsPage.tsx`

### ç±»å‹å®šä¹‰

- **Task ç±»å‹**ï¼š`src/remindMe/types.ts`
- **RoutineCompletion ç±»å‹**ï¼š`src/remindMe/services/routineCompletionService.ts`

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. æ—¶åŒºå¤„ç†

å½“å‰ä½¿ç”¨ `new Date().toISOString().split('T')[0]` è·å–ä»Šå¤©çš„æ—¥æœŸï¼Œè¿™ä¼šä½¿ç”¨æµè§ˆå™¨çš„æœ¬åœ°æ—¶åŒºã€‚

**å»ºè®®**ï¼šæœªæ¥å¯ä»¥è€ƒè™‘åœ¨æ•°æ®åº“ä¸­å­˜å‚¨ç”¨æˆ·çš„æ—¶åŒºåå¥½ï¼Œç¡®ä¿è·¨æ—¶åŒºçš„æ­£ç¡®æ€§ã€‚

### 2. æ•°æ®ä¸€è‡´æ€§

- Routine ä»»åŠ¡çš„å®ŒæˆçŠ¶æ€åˆ†ä¸¤ä¸ªåœ°æ–¹å­˜å‚¨ï¼š
  - `tasks.completed_reminder` - ä»»åŠ¡æœ¬èº«æ˜¯å¦å®Œæˆï¼ˆä»Šå¤©ï¼‰
  - `routine_completions` - å†å²å®Œæˆè®°å½•

**å»ºè®®**ï¼šä¿æŒè¿™ä¸¤ä¸ªå­—æ®µçš„ä¸€è‡´æ€§ï¼Œæˆ–è€…åªä½¿ç”¨ `routine_completions` è¡¨ã€‚

### 3. æ€§èƒ½ä¼˜åŒ–

- å½“å‰ä¸€æ¬¡åŠ è½½æ‰€æœ‰ Routine ä»»åŠ¡çš„å®Œæˆå†å²
- å¦‚æœç”¨æˆ·æœ‰å¾ˆå¤š Routine ä»»åŠ¡ï¼Œå¯èƒ½ä¼šå½±å“æ€§èƒ½

**å»ºè®®**ï¼šå®ç°åˆ†é¡µåŠ è½½æˆ–æŒ‰éœ€åŠ è½½ã€‚

---

## ğŸ‰ æ€»ç»“

### å·²å®ç°çš„åŠŸèƒ½

âœ… åˆ›å»º `routine_completions` è¡¨è®°å½•æ‰“å¡å†å²  
âœ… å®ç°æœåŠ¡å±‚å‡½æ•°æ“ä½œå®Œæˆè®°å½•  
âœ… åˆ›å»ºçƒ­åŠ›å›¾ç»„ä»¶æ˜¾ç¤ºæ‰“å¡å†å²  
âœ… åˆ›å»º Routine ä»»åŠ¡é¡¹ç»„ä»¶ï¼ˆå¸¦çƒ­åŠ›å›¾ï¼‰  
âœ… **åªèƒ½ç‚¹äº®ä»Šå¤©çš„æ ¼å­**ï¼ˆæ ¸å¿ƒçº¦æŸï¼‰  
âœ… æ ¼å­é¢œè‰²å¾ªç¯ï¼ˆé»„â†’è“â†’çº¢ï¼‰  
âœ… å±•å¼€/æ”¶èµ·çƒ­åŠ›å›¾  
âœ… å®æ—¶åŒæ­¥åˆ° Supabase  
âœ… è·¨è®¾å¤‡åŒæ­¥

### ç”¨æˆ·ä½“éªŒ

- ç›´è§‚çš„æ‰“å¡æ—¥å†ï¼Œç±»ä¼¼ GitHub è´¡çŒ®å›¾
- æ¸…æ™°çš„é¢œè‰²ç³»ç»Ÿï¼Œæ˜“äºè¯†åˆ«
- åªèƒ½æ“ä½œä»Šå¤©çš„ä»»åŠ¡ï¼Œä¿è¯æ•°æ®çœŸå®æ€§
- å®æ—¶åé¦ˆï¼Œæ“ä½œæµç•…

---

**å®ç°å®Œæˆæ—¥æœŸ**ï¼š2025å¹´11æœˆ26æ—¥  
**å®ç°è€…**ï¼šAI Assistant  
**æ•°æ®åº“**ï¼šSupabase PostgreSQL  
**æ¡†æ¶**ï¼šReact 19 + TypeScript + Tailwind CSS

