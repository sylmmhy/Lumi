# æ™ºèƒ½è™šæ‹Ÿæ¶ˆæ¯ç³»ç»Ÿ - AI Coach Guidance

> **çŠ¶æ€**: è®¾è®¡ä¸­
> **åˆ›å»ºæ—¥æœŸ**: 2026-02-04
> **ç›®æ ‡**: è®©è™šæ‹Ÿæ¶ˆæ¯ä»"æœºæ¢°è§¦å‘è¯"å‡çº§ä¸º"ç»è¿‡ AI æ€è€ƒçš„æ™ºèƒ½å»ºè®®"

---

## 1. é—®é¢˜èƒŒæ™¯

### å½“å‰é—®é¢˜

ç”¨æˆ·å’Œ AI èŠå¤©æ—¶ï¼Œè¯é¢˜ä»"æ”¶æ‹¾è¡Œæ"å˜æˆäº†"æ„Ÿæƒ…é—®é¢˜"ã€‚ä½†å½“ç”¨æˆ·æ²‰é»˜ 15 ç§’åï¼Œè™šæ‹Ÿæ¶ˆæ¯ç³»ç»Ÿå‘é€äº† `[CHECK_IN] elapsed=1m`ï¼ŒAI æ”¶åˆ°åå›å¤ï¼š"Maybe just start one tiny, easy thing to pack..."

**ä¸Šä¸‹æ–‡æ–­è£‚äº†** - AI å¥½åƒ"å¤±å¿†"ï¼Œä»æ„Ÿæƒ…è¯é¢˜çªç„¶è·³å›ä»»åŠ¡ã€‚

### æ ¹æœ¬åŸå› 

å½“å‰è™šæ‹Ÿæ¶ˆæ¯ç³»ç»Ÿåªçœ‹**æ—¶é—´**ï¼Œä¸çœ‹**ä¸Šä¸‹æ–‡**ï¼š

```
å½“å‰ï¼š[CHECK_IN] elapsed=1m language=en-US
      â†“
AI æŒ‰è§¦å‘è¯å®šä¹‰å›å¤ â†’ é—®ä»»åŠ¡è¿›åº¦ â†’ ä¸Šä¸‹æ–‡æ–­è£‚
```

---

## 2. è§£å†³æ–¹æ¡ˆï¼šAI Coach Guidance

### æ ¸å¿ƒæ€è·¯

åœ¨å‘é€è™šæ‹Ÿæ¶ˆæ¯å‰ï¼Œå…ˆè®©ä¸€ä¸ª"AI æ€è€ƒè€…"åˆ†æå½“å‰ä¸Šä¸‹æ–‡ï¼Œç”Ÿæˆä¸€å¼ "å°çº¸æ¡"ï¼ˆGuidanceï¼‰ï¼Œå‘Šè¯‰ Gemini Live AI åº”è¯¥æ€ä¹ˆåšã€‚

### æ¶æ„å›¾

```
ç”¨æˆ·æ²‰é»˜ 15 ç§’...
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ§  AI æ€è€ƒè€… (generate-coach-guidance Edge Function)       â”‚
â”‚                                                             â”‚
â”‚  è¾“å…¥ï¼š                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ â€¢ currentTopic: "æ„Ÿæƒ…"                               â”‚   â”‚
â”‚  â”‚ â€¢ userEmotion: "sad"                                â”‚   â”‚
â”‚  â”‚ â€¢ emotionIntensity: 0.7                             â”‚   â”‚
â”‚  â”‚ â€¢ recentMemories: ["ç”·æœ‹å‹ä¸èƒ½ä¸€èµ·å»è¿ªå£«å°¼", ...]    â”‚   â”‚
â”‚  â”‚ â€¢ conversationSummary: "ç”¨æˆ·æƒ³èŠç”·æœ‹å‹çš„äº‹..."      â”‚   â”‚
â”‚  â”‚ â€¢ taskDescription: "æ”¶æ‹¾è¡Œæ"                        â”‚   â”‚
â”‚  â”‚ â€¢ elapsedMinutes: 1                                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                           â†“                                 â”‚
â”‚                    Gemini 3 Flash æ€è€ƒ                      â”‚
â”‚                           â†“                                 â”‚
â”‚  è¾“å‡ºï¼ˆå°çº¸æ¡ï¼‰ï¼š                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ "The user is sharing emotional struggles about      â”‚   â”‚
â”‚  â”‚  their boyfriend. They seem sad and need to be      â”‚   â”‚
â”‚  â”‚  heard first. DO NOT mention packing or the task.   â”‚   â”‚
â”‚  â”‚  Just listen and validate their feelings."          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
    å‘é€ç»™ Gemini Live AIï¼ˆä½œä¸ºè™šæ‹Ÿæ¶ˆæ¯ï¼‰
         â†“
    Gemini Live æ ¹æ®"å°çº¸æ¡"è‡ªç„¶å›å¤
```

---

## 3. Edge Function è®¾è®¡

### 3.1 å‡½æ•°ä¿¡æ¯

| å±æ€§ | å€¼ |
|------|-----|
| **å‡½æ•°å** | `generate-coach-guidance` |
| **è·¯å¾„** | `supabase/functions/generate-coach-guidance/index.ts` |
| **æ¨¡å‹** | Gemini 3 Flash (`gemini-3.0-flash`) |
| **è¾“å‡ºè¯­è¨€** | è‹±æ–‡ï¼ˆé»˜è®¤ï¼‰ |

### 3.2 è¯·æ±‚æ ¼å¼

```typescript
interface CoachGuidanceRequest {
  /** ç”¨æˆ· ID */
  userId: string;

  /** å½“å‰æ£€æµ‹åˆ°çš„è¯é¢˜ */
  currentTopic: string;

  /** ç”¨æˆ·æƒ…ç»ª */
  userEmotion: 'happy' | 'sad' | 'anxious' | 'frustrated' | 'tired' | 'neutral';

  /** æƒ…ç»ªå¼ºåº¦ (0-1) */
  emotionIntensity: number;

  /** ç›¸å…³è®°å¿†ï¼ˆæ¥è‡ªè®°å¿†æ£€ç´¢ï¼‰ */
  recentMemories: Array<{
    content: string;
    tag: string;
  }>;

  /** æœ€è¿‘å¯¹è¯æ‘˜è¦ */
  conversationSummary: string;

  /** ç”¨æˆ·æœ€åè¯´çš„è¯ */
  lastUserSpeech: string;

  /** ä»»åŠ¡æè¿° */
  taskDescription: string;

  /** ä»»åŠ¡å·²è¿›è¡Œæ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰ */
  elapsedMinutes: number;

  /** ç”¨æˆ·é¦–é€‰è¯­è¨€ï¼ˆç”¨äº AI å›å¤æ—¶å‚è€ƒï¼Œä½† guidance æœ¬èº«ç”¨è‹±æ–‡ï¼‰ */
  userPreferredLanguage?: string;
}
```

### 3.3 å“åº”æ ¼å¼

```typescript
interface CoachGuidanceResponse {
  /** ç»™ Gemini Live çš„æŒ‡å¯¼ï¼ˆè‹±æ–‡ï¼‰ */
  guidance: string;

  /** å»ºè®®çš„è¯­æ°” */
  suggestedTone: 'empathetic' | 'encouraging' | 'gentle' | 'playful' | 'neutral';

  /** åº”è¯¥é¿å…çš„è¯é¢˜ */
  avoidTopics: string[];

  /** å»ºè®®çš„ä¸‹ä¸€æ­¥åŠ¨ä½œ */
  nextAction: 'listen' | 'validate' | 'gentle_redirect' | 'encourage_task' | 'celebrate';

  /** æ˜¯å¦åº”è¯¥æåŠä»»åŠ¡ */
  shouldMentionTask: boolean;
}
```

### 3.4 System Prompt è®¾è®¡

```typescript
const SYSTEM_PROMPT = `You are an AI Coach advisor. Your job is to analyze the current conversation context and provide guidance for the frontline AI coach (Gemini Live) on how to respond.

## Your Role
- You observe the user's emotional state, conversation topic, and relevant memories
- You decide what the AI coach should do next
- You write a brief guidance note (the "å°çº¸æ¡") for the AI coach

## Output Requirements
- Write guidance in ENGLISH (the AI coach will respond in user's preferred language)
- Be specific and actionable
- Include what TO DO and what NOT TO DO
- Keep it concise (2-4 sentences max)

## Decision Framework

### When user is emotional (emotionIntensity > 0.5):
- Priority: Listen and validate feelings
- DO NOT push task-related topics
- Suggest empathetic responses

### When user is discussing off-topic but neutral:
- Gently acknowledge, then see if they want to refocus
- Don't force redirect

### When user seems ready for task:
- Encourage small steps
- Use their past successes as motivation

### When user shows resistance:
- Acknowledge the resistance
- Offer smaller alternatives
- Never be pushy

## Output Format
Return a JSON object with:
- guidance: string (the main instruction for AI coach)
- suggestedTone: "empathetic" | "encouraging" | "gentle" | "playful" | "neutral"
- avoidTopics: string[] (topics to avoid mentioning)
- nextAction: "listen" | "validate" | "gentle_redirect" | "encourage_task" | "celebrate"
- shouldMentionTask: boolean`
```

### 3.5 ç¤ºä¾‹è¾“å…¥è¾“å‡º

**è¾“å…¥ç¤ºä¾‹**:
```json
{
  "userId": "xxx",
  "currentTopic": "æ„Ÿæƒ…",
  "userEmotion": "sad",
  "emotionIntensity": 0.7,
  "recentMemories": [
    { "content": "User's boyfriend cannot join the Disneyland trip", "tag": "CONTEXT" },
    { "content": "User feels emotionally frozen when sad about relationships", "tag": "EMO" }
  ],
  "conversationSummary": "User started talking about packing for Disneyland, then shifted to discussing their complicated relationship with their boyfriend.",
  "lastUserSpeech": "It's complicated... our relationship is complicated.",
  "taskDescription": "Pack for Disneyland trip",
  "elapsedMinutes": 1,
  "userPreferredLanguage": "en-US"
}
```

**è¾“å‡ºç¤ºä¾‹**:
```json
{
  "guidance": "The user is opening up about relationship struggles and feeling sad. They shifted away from packing because emotions are overwhelming them. DO: Listen actively, validate their feelings, ask open questions about what's on their mind. DO NOT: Mention packing, Disneyland, or try to redirect to the task right now.",
  "suggestedTone": "empathetic",
  "avoidTopics": ["packing", "Disneyland", "task", "luggage"],
  "nextAction": "listen",
  "shouldMentionTask": false
}
```

---

## 4. å‰ç«¯é›†æˆ

### 4.1 è°ƒç”¨æ—¶æœº

åœ¨ `useVirtualMessages.ts` ä¸­ï¼Œå½“å‡†å¤‡å‘é€è™šæ‹Ÿæ¶ˆæ¯æ—¶ï¼š

```typescript
// ä¹‹å‰ï¼šç›´æ¥å‘é€è§¦å‘è¯
const message = await generateTimeAwareMessage(category);
onSendMessage(message);

// ä¹‹åï¼šå…ˆè·å– AI guidanceï¼Œå†å‘é€
const guidance = await fetchCoachGuidance({
  currentTopic: orchestrator.getContext().currentTopic,
  userEmotion: orchestrator.getContext().emotionalState,
  // ... å…¶ä»–å‚æ•°
});

// å‘é€ guidance ä½œä¸ºè™šæ‹Ÿæ¶ˆæ¯
onSendMessage(`[COACH_GUIDANCE] ${guidance.guidance}`);
```

### 4.2 æ–°å¢è§¦å‘è¯æ ¼å¼

```
[COACH_GUIDANCE] <guidance content>
```

éœ€è¦åœ¨ Gemini Live çš„ System Prompt ä¸­æ·»åŠ å¯¹ `[COACH_GUIDANCE]` çš„å¤„ç†è¯´æ˜ã€‚

### 4.3 æ•°æ®æµ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         å‰ç«¯ (React)                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  useVirtualMessages          useVirtualMessageOrchestrator      â”‚
â”‚       â”‚                              â”‚                          â”‚
â”‚       â”‚ å®šæ—¶è§¦å‘                      â”‚ æä¾›ä¸Šä¸‹æ–‡               â”‚
â”‚       â–¼                              â–¼                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚        å‡†å¤‡å‘é€è™šæ‹Ÿæ¶ˆæ¯                      â”‚               â”‚
â”‚  â”‚                                             â”‚               â”‚
â”‚  â”‚  1. ä» Orchestrator è·å–ä¸Šä¸‹æ–‡              â”‚               â”‚
â”‚  â”‚     - currentTopic                          â”‚               â”‚
â”‚  â”‚     - userEmotion                           â”‚               â”‚
â”‚  â”‚     - conversationSummary                   â”‚               â”‚
â”‚  â”‚                                             â”‚               â”‚
â”‚  â”‚  2. ä» MemoryPipeline è·å–ç›¸å…³è®°å¿†          â”‚               â”‚
â”‚  â”‚                                             â”‚               â”‚
â”‚  â”‚  3. è°ƒç”¨ generate-coach-guidance            â”‚               â”‚
â”‚  â”‚                                             â”‚               â”‚
â”‚  â”‚  4. å‘é€ guidance ç»™ Gemini Live            â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                          â”‚                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Supabase Edge Function                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  generate-coach-guidance                                        â”‚
â”‚       â”‚                                                         â”‚
â”‚       â”‚ è°ƒç”¨ Gemini 3 Flash                                   â”‚
â”‚       â–¼                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚  åˆ†æä¸Šä¸‹æ–‡ â†’ ç”Ÿæˆ guidance                  â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚       â”‚                                                         â”‚
â”‚       â–¼                                                         â”‚
â”‚  è¿”å› CoachGuidanceResponse                                     â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. Gemini Live System Prompt æ›´æ–°

éœ€è¦åœ¨ System Prompt ä¸­æ·»åŠ å¯¹æ–°è§¦å‘è¯çš„å¤„ç†ï¼š

```markdown
## [COACH_GUIDANCE] - AI Coach Guidance

When you receive a message starting with [COACH_GUIDANCE], this is internal guidance from the coaching system about how to respond.

**Rules:**
1. DO NOT repeat or mention the guidance content to the user
2. Follow the guidance naturally in your response
3. Respond in the user's preferred language (not English unless that's their preference)
4. The guidance tells you:
   - What emotional state the user is in
   - What topics to avoid
   - What approach to take

**Example:**
Input: [COACH_GUIDANCE] The user is feeling sad about their relationship. Listen and validate. Do not mention the task.

Your response: (in user's language, empathetically asking about their feelings, NOT mentioning any task)
```

---

## 6. å®ç°æ­¥éª¤

### Phase 1: åç«¯ (Edge Function)

- [ ] åˆ›å»º `generate-coach-guidance` Edge Function
- [ ] é…ç½® Gemini 3 Flash API è°ƒç”¨
- [ ] ç¼–å†™ System Prompt
- [ ] æµ‹è¯•è¾“å…¥è¾“å‡ºæ ¼å¼
- [ ] éƒ¨ç½²åˆ° Supabase

### Phase 2: å‰ç«¯é›†æˆ

- [ ] åœ¨ `useVirtualMessages.ts` ä¸­æ·»åŠ  guidance è·å–é€»è¾‘
- [ ] ä» Orchestrator è·å–ä¸Šä¸‹æ–‡æ•°æ®
- [ ] é›†æˆè®°å¿†æ£€ç´¢
- [ ] ä¿®æ”¹è™šæ‹Ÿæ¶ˆæ¯å‘é€é€»è¾‘

### Phase 3: Gemini Live é€‚é…

- [ ] æ›´æ–° System Promptï¼Œæ·»åŠ  `[COACH_GUIDANCE]` å¤„ç†è¯´æ˜
- [ ] æµ‹è¯• AI æ˜¯å¦æ­£ç¡®éµå¾ª guidance
- [ ] éªŒè¯ä¸Šä¸‹æ–‡ä¸å†æ–­è£‚

---

## 7. æ³¨æ„äº‹é¡¹

### å»¶è¿Ÿè€ƒè™‘

- Gemini 3 Flash è°ƒç”¨é¢„è®¡ 500ms - 1.5s
- ç”¨æˆ·åœ¨æ²‰é»˜ä¸­ï¼Œè¿™ä¸ªå»¶è¿Ÿå¯æ¥å—
- å¯ä»¥è€ƒè™‘åœ¨ç”¨æˆ·è¯´è¯æ—¶å°±é¢„å…ˆè·å– guidanceï¼ˆé¢„å–ä¼˜åŒ–ï¼‰

### æˆæœ¬è€ƒè™‘

- æ¯æ¬¡è™šæ‹Ÿæ¶ˆæ¯è§¦å‘ä¸€æ¬¡ API è°ƒç”¨
- ä½¿ç”¨ Flash æ¨¡å‹ï¼Œæˆæœ¬è¾ƒä½
- ä¿æŒ 15 ç§’å†·å´æ—¶é—´ï¼Œé¿å…é¢‘ç¹è°ƒç”¨

### å¤±è´¥å¤„ç†

- å¦‚æœ API è°ƒç”¨å¤±è´¥ï¼Œå›é€€åˆ°ç®€å•çš„ `[CHECK_IN]` è§¦å‘è¯
- æ·»åŠ è¶…æ—¶å¤„ç†ï¼ˆ2 ç§’è¶…æ—¶ï¼‰

---

## 8. æˆåŠŸæŒ‡æ ‡

| æŒ‡æ ‡ | ç›®æ ‡ |
|------|------|
| ä¸Šä¸‹æ–‡æ–­è£‚ç‡ | ä» ~50% é™åˆ° <10% |
| API å“åº”æ—¶é—´ | < 1.5s (P95) |
| ç”¨æˆ·æ»¡æ„åº¦ | AI æ„Ÿè§‰"è®°å¾—"ä¹‹å‰èŠçš„å†…å®¹ |

---

## 9. ç›¸å…³æ–‡ä»¶

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `supabase/functions/generate-coach-guidance/index.ts` | Edge Function (å¾…åˆ›å»º) |
| `src/hooks/useVirtualMessages.ts` | è™šæ‹Ÿæ¶ˆæ¯ç³»ç»Ÿ (å¾…ä¿®æ”¹) |
| `src/hooks/virtual-messages/useVirtualMessageOrchestrator.ts` | è°ƒåº¦å™¨ (æä¾›ä¸Šä¸‹æ–‡) |
| `src/hooks/useGeminiSession.ts` | Gemini Live System Prompt (å¾…æ›´æ–°) |
