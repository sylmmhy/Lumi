# PRD: Stats 页面重构 - 蓄水池设计

**文档版本**: v1.0
**创建日期**: 2026-01-18
**产品负责人**: [待填写]
**开发负责人**: [待填写]

---

## 1. 背景与问题

### 1.1 当前状态
Stats 页面顶部显示用户的"**连胜天数**"（Streak）。

### 1.2 用户痛点

| 痛点 | 具体表现 | 影响 |
|------|---------|------|
| **断签焦虑** | 用户害怕断签，因为连胜会归零 | 产生压力，与产品"减压"定位冲突 |
| **放弃心理** | 一旦断签，用户觉得"反正已经断了"就不再继续 | 用户流失 |
| **负面激励** | "连续 0 天"是一种负面提示 | 打击用户信心 |

### 1.3 竞品参考
- **Duolingo**：使用连胜机制，但被批评"让学习变得有压力"
- **Forest**：累计种树，永不清零，正向激励
- **Finch**：养成类，累计行为让宠物成长

---

## 2. 产品目标

### 2.1 核心目标
> **让用户感受到"每一次努力都有价值"，而不是"必须每天坚持否则前功尽弃"**

### 2.2 量化指标

| 指标 | 当前基准 | 目标 | 衡量方式 |
|------|---------|------|---------|
| 断签后次日留存率 | 待测量 | +20% | 断签用户第二天是否回来打卡 |
| 周打卡完成率 | 待测量 | +15% | 平均每用户每周完成的打卡数 |
| 用户满意度 | 待测量 | NPS +10 | 用户反馈 |

---

## 3. 功能方案

### 3.1 蓄水池（核心功能）

**位置**: Stats 页面顶部，替换原来的"连胜天数"

**视觉效果**:
```
┌─────────────────────────────────────┐
│                                     │
│     "You're building momentum!"     │  ← 鼓励文案
│                                     │
│            ╭───────────╮            │
│            │  ~~~~~~~  │            │  ← 波浪动画
│            │   12/20   │            │  ← 本周进度
│            │  ███████  │            │  ← 水位（60%）
│            │  ███████  │            │
│            ╰───────────╯            │
│                                     │
│        "本周完成 12 个任务"          │  ← 说明文字
│                                     │
└─────────────────────────────────────┘
```

**交互说明**:
| 场景 | 表现 |
|------|------|
| 进入页面 | 水位按当前进度静态显示，波浪轻微晃动 |
| 完成一个任务 | 水位上涨动画（约 0.5 秒），波浪幅度变大 |
| 达到目标（20/20） | 水满溢出特效 + 庆祝动画 |
| 新的一周开始 | 水位重置为 0（但不是"断签"，只是"新周期"） |

**关键规则**:
- ✅ 水位只会上涨，不会因为"断签"而下降
- ✅ 每周一重置为新周期，是自然的时间节点，不是惩罚
- ✅ 目标值暂定 20 个任务/周（后续可做 A/B 测试调整）

---

### 3.2 里程碑进度条

**位置**: 每个习惯卡片的底部

**视觉效果**:
```
┌─────────────────────────────────────┐
│  🏃 每日运动                         │
│  ☑️☑️☑️☑️☑️☐☐  (本周 5/7)             │
│                                     │
│  [██████████░░░░░░░░░░] 25/30       │  ← 里程碑进度条
│        ↑ 已完成   ↑ 下一里程碑        │
│                                     │
│  "再完成 5 次，解锁 30 次成就！"       │  ← 激励文案
└─────────────────────────────────────┘
```

**里程碑节点**: 10 → 30 → 60 → 100 → 200 → 500 次

**交互说明**:
| 场景 | 表现 |
|------|------|
| 普通打卡 | 进度条增长 + 数字 +1 |
| 达到里程碑 | 进度条发光 + 庆祝 Toast + 解锁成就 |
| 超过最高里程碑 | 进度条保持满格，显示总数 |

**关键规则**:
- ✅ 里程碑数值是**累计值**，永远不会清零
- ✅ 即使用户一周没打卡，回来后看到的是"你已经累计 47 次"，而不是"你断签了 7 天"

---

### 3.3 打卡成功 Toast

**触发时机**: 用户点击打卡按钮后

**视觉效果**:
```
┌─────────────────────────────────────┐
│                                     │
│     ✨ "You showed up! That's a win." │
│                                     │
└─────────────────────────────────────┘
          （2 秒后自动消失）
```

**文案池**（随机展示）:
- "You showed up! That's a win."
- "干得漂亮！"
- "又积攒了一次！"
- "Keep going! 🔥"
- "一步一步，稳稳前进"
- "Nice! 坚持就是胜利"

---

### 3.4 联动动效

**用户操作**: 点击习惯卡片的"打卡"按钮

**动画序列**:
```
1. 按钮弹跳（放大 1.25 倍 → 恢复）     ← 即时反馈
       ↓
2. 卡片里程碑进度条增长               ← 局部反馈
       ↓
3. 顶部蓄水池水位上涨                 ← 全局反馈
       ↓
4. Toast 出现并消失                   ← 文字鼓励
```

**时间线**:
- 0ms: 按钮弹跳
- 100ms: 进度条开始增长
- 200ms: 水位开始上涨
- 300ms: Toast 出现
- 2300ms: Toast 消失

---

## 4. 设计规范

### 4.1 配色方案

| 元素 | 颜色 | 说明 |
|------|------|------|
| 蓄水池水位 | `#F5D76E`（金色） | 温暖、积极 |
| 蓄水池背景 | `#F0F0F0`（浅灰） | 低调，突出水位 |
| 波浪高光 | `rgba(255,255,255,0.3)` | 立体感 |
| 里程碑进度条 | `#4ECDC4`（青色） | 清新、成长 |

### 4.2 文案风格

| 场景 | 风格 | 示例 |
|------|------|------|
| 蓄水池标题 | 正向激励 | "You're building momentum!" |
| 里程碑提示 | 具体目标 | "再完成 5 次，解锁 30 次成就！" |
| Toast 文案 | 简短有力 | "又积攒了一次！" |

---

## 5. 用户故事

### 故事 1：正常打卡
> 小明打开 App，看到蓄水池显示"本周 8/20"。他点击"每日运动"的打卡按钮，按钮弹跳，进度条增长，水位上涨到 9/20，Toast 显示"Keep going! 🔥"。小明感到开心，因为看到自己在进步。

### 故事 2：断签后回来
> 小红上周很忙，一周没用 App。今天她打开 Stats 页面，看到蓄水池是"本周 0/20"（新周期），但里程碑显示"累计 47 次"。她想："虽然这周还没开始，但我之前的努力都在！"于是继续打卡。

### 故事 3：达到里程碑
> 小张连续使用 App 一个月，今天完成第 100 次运动打卡。进度条发光，Toast 显示"🎉 恭喜解锁 100 次成就！"，蓄水池也满了。他截图发朋友圈，感到非常有成就感。

---

## 6. 技术依赖

| 依赖项 | 说明 | 状态 |
|--------|------|------|
| tasks 表 | 已有 `status`、`completed_at` 字段 | ✅ 可用 |
| 已有索引 | `idx_tasks_user_completed` 可直接利用 | ✅ 可用 |
| SVG 动画 | CSS keyframes 实现波浪效果 | 🔨 需开发 |

---

## 7. 待确认事项

| # | 问题 | 选项 | 默认值 |
|---|------|------|--------|
| 1 | "本周"定义 | A. 周一~周日 / B. 过去7天滚动 | A |
| 2 | 周目标值 | 固定 20 / 用户可配置 | 固定 20 |
| 3 | 里程碑数值 | [10, 30, 60, 100, 200, 500] | 是 |
| 4 | 是否需要 Figma 设计稿 | 是 / 开发自行实现 | 待确认 |
| 5 | 水位颜色 | 金色 / 青色 / 其他 | 金色 |

---

## 8. 排期建议

| 阶段 | 内容 | 产出物 |
|------|------|--------|
| 设计阶段 | 确认待确认事项、出 Figma 稿 | 设计稿 |
| 开发阶段 | 前端组件开发 | 代码 |
| 测试阶段 | 功能测试、动画调优 | 测试报告 |
| 上线阶段 | 灰度发布、A/B 测试 | 数据报告 |

---

## 9. 成功标准

上线后 2 周内观察：
1. **断签后次日留存率** 提升 20%
2. **用户周打卡数** 提升 15%
3. **负面反馈**（如"断签好沮丧"）减少 50%

---

## 10. 附录

### 10.1 相关文档
- 技术实现计划：`docs/in-progress/20260118-stats-page-redesign.md`

### 10.2 修订记录
| 版本 | 日期 | 修改内容 | 作者 |
|------|------|---------|------|
| v1.0 | 2026-01-18 | 初稿 | Claude |
